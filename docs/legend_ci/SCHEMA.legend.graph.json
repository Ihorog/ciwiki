{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://github.com/Ihorog/ciwiki/docs/legend_ci/SCHEMA.legend.graph.json",
  "title": "Legend Ci Graph Schema",
  "description": "Validates the canonical Legend Ci knowledge graph (legend.graph.json)",
  "type": "object",
  "required": ["version", "center", "nodes", "edges"],
  "additionalProperties": false,
  "properties": {
    "version": {
      "type": "string",
      "description": "Semver of this graph file"
    },
    "center": {
      "$ref": "#/definitions/centerNode"
    },
    "nodes": {
      "type": "array",
      "minItems": 1,
      "items": { "$ref": "#/definitions/node" },
      "description": "Concept nodes surrounding the center"
    },
    "edges": {
      "type": "array",
      "items": { "$ref": "#/definitions/edge" },
      "description": "Directed or bidirectional connections between nodes"
    },
    "meta": {
      "type": "object",
      "description": "Global presentation/layout hints",
      "properties": {
        "default_layout": { "type": "string" },
        "default_nav_mode": {
          "type": "string",
          "enum": ["linear", "non-linear", "resonance"]
        },
        "hex_facets": {
          "type": "array",
          "items": { "type": "string" }
        },
        "animation": { "type": "string" },
        "ui": {
          "type": "object",
          "description": "UI-specific settings for interactive rendering",
          "properties": {
            "default_mode": { "type": "string" },
            "depth_rings": {
              "type": "array",
              "items": { "type": "string" },
              "description": "Named depth levels: overview / immersion / integration"
            }
          }
        }
      }
    }
  },
  "definitions": {
    "centerNode": {
      "type": "object",
      "required": ["id", "title"],
      "additionalProperties": false,
      "properties": {
        "id": { "type": "string", "pattern": "^[a-z0-9_-]+$" },
        "title": { "type": "string" },
        "summary": { "type": "string" }
      }
    },
    "node": {
      "type": "object",
      "required": ["id", "title", "layers"],
      "additionalProperties": false,
      "properties": {
        "id": {
          "type": "string",
          "pattern": "^[a-z0-9_-]+$",
          "description": "Unique snake_case identifier"
        },
        "title": { "type": "string" },
        "index": {
          "type": "integer",
          "minimum": 1,
          "maximum": 20
        },
        "group": {
          "type": "string",
          "description": "Arc/chapter group the node belongs to"
        },
        "summary": {
          "type": "string",
          "description": "Short human-readable summary (mirrors layers.public)"
        },
        "layers": { "$ref": "#/definitions/layers" },
        "meta": { "$ref": "#/definitions/nodeMeta" }
      }
    },
    "layers": {
      "type": "object",
      "required": ["public", "deep", "examples"],
      "additionalProperties": false,
      "properties": {
        "public": {
          "type": "string",
          "description": "Metaphor / accessible summary for general audience"
        },
        "deep": {
          "type": "string",
          "description": "Scientific / philosophical elaboration"
        },
        "examples": {
          "type": "array",
          "items": { "type": "string" },
          "description": "Concrete examples or practice notes"
        }
      }
    },
    "nodeMeta": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "animation": { "type": "string" },
        "layout_hint": {
          "type": "string",
          "enum": ["radial", "hex", "linear", "cluster"]
        },
        "hex_facet": { "type": "string" },
        "tags": {
          "type": "array",
          "items": { "type": "string" }
        }
      }
    },
    "edge": {
      "type": "object",
      "required": ["from", "to", "type"],
      "additionalProperties": false,
      "properties": {
        "from": { "type": "string" },
        "to": { "type": "string" },
        "type": {
          "type": "string",
          "enum": ["linear", "resonance", "contrast", "emergence", "return"]
        },
        "label": { "type": "string" },
        "bidirectional": { "type": "boolean" }
      }
    }
  }
}
