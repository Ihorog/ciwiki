# SYSTEM_WILL ‚Äî –ê—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–∞ CiWiki / Cimeika

## –û–≥–ª—è–¥

CiWiki ‚Äî —î–¥–∏–Ω–∏–π —Å—Ç–∞—Ç–∏—á–Ω–∏–π —Å–∞–π—Ç, —â–æ —î –ø—É–±–ª—ñ—á–Ω–∏–º —à–∞—Ä–æ–º (outer) —ñ –º—ñ—Å—Ç–∏—Ç—å –≤–Ω—É—Ç—Ä—ñ—à–Ω—ñ–π —Å–≤—ñ—Ç Legend CI (inner). –°–∞–π—Ç –±—É–¥—É—î—Ç—å—Å—è —á–µ—Ä–µ–∑ MkDocs (Material theme) —ñ –¥–µ–ø–ª–æ—ó—Ç—å—Å—è –Ω–∞ GitHub Pages –∑–∞ –∞–¥—Ä–µ—Å–æ—é `https://www.cimeika.com.ua/`.

## –î–≤–∞ —à–∞—Ä–∏

| –®–∞—Ä | –ù–∞–∑–≤–∞ | –®–ª—è—Ö | –í–∏–¥–∏–º—ñ—Å—Ç—å |
|-----|-------|------|-----------|
| Outer | CiWiki | `/` | –ü—É–±–ª—ñ—á–Ω–∏–π |
| Inner | Legend CI | `/legend/` | –í–Ω—É—Ç—Ä—ñ—à–Ω—ñ–π (no public indexing) |

**Outer (CiWiki)** ‚Äî –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—è, –ø—Ä–æ—Ü–µ—Å–∏, –∫–æ–Ω—Ü–µ–ø—Ü—ñ—ó Cimeika. –î–æ—Å—Ç—É–ø–Ω–∏–π –¥–ª—è –≤—Å—ñ—Ö.

**Inner (Legend CI)** ‚Äî –∂–∏–≤–∞ –∫–æ—Å–º–æ–ª–æ–≥—ñ—è Cimeika: 20 –≤—É–∑–ª—ñ–≤ + —Ü–µ–Ω—Ç—Ä Ci, –æ—Ä–≥–∞–Ω—ñ–∑–æ–≤–∞–Ω–∏—Ö —É —à–∞—Ä–∏ (public / deep / examples). –ü–æ–∑–Ω–∞—á–µ–Ω–∏–π –≤ UI —è–∫ `[internal]`. –ö–æ–Ω—Ç–µ–Ω—Ç –¥–æ—Å—Ç—É–ø–Ω–∏–π —Å—Ç–∞—Ç–∏—á–Ω–æ, –∞–ª–µ –Ω–µ —Ä–µ–∫–ª–∞–º—É—î—Ç—å—Å—è.

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ—î–∫—Ç—É

```
ciwiki/
‚îú‚îÄ‚îÄ docs/                        # –£—Å—ñ –¥–∂–µ—Ä–µ–ª–∞ MkDocs
‚îÇ   ‚îú‚îÄ‚îÄ index.md                 # –ì–æ–ª–æ–≤–Ω–∞ —Å—Ç–æ—Ä—ñ–Ω–∫–∞ (outer)
‚îÇ   ‚îú‚îÄ‚îÄ legend/                  # Inner world ‚Äî Legend CI
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ index.md             # Landing page –¥–ª—è /legend/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ legend_map.html      # –ê–≤—Ç–æ–Ω–æ–º–Ω–∞ HTML-–∫–∞—Ä—Ç–∞ –≤—É–∑–ª—ñ–≤
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ <node>/index.html    # –°—Ç–æ—Ä—ñ–Ω–∫–∏ –≤—É–∑–ª—ñ–≤ (20 —à—Ç—É–∫)
‚îÇ   ‚îú‚îÄ‚îÄ legend_ci/               # –î–∞–Ω—ñ Legend CI (JSON, Markdown)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ legend.graph.json    # Source-of-truth –≥—Ä–∞—Ñ
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ legend.nodes.md      # –ó–≥–µ–Ω–µ—Ä–æ–≤–∞–Ω–∏–π —Å–ø–∏—Å–æ–∫ –≤—É–∑–ª—ñ–≤
‚îÇ   ‚îú‚îÄ‚îÄ kazkar/legend-ci/        # –ù–∞—Ä–∞—Ç–∏–≤–Ω—ñ —Ä–æ–∑–¥—ñ–ª–∏ (7 –∞–∫—Ç—ñ–≤)
‚îÇ   ‚îî‚îÄ‚îÄ ...                      # –Ü–Ω—à—ñ —Ä–æ–∑–¥—ñ–ª–∏ (ci, podija, —Ç–æ—â–æ)
‚îú‚îÄ‚îÄ scripts/legend/              # –°–∫—Ä–∏–ø—Ç–∏ –¥–ª—è Legend CI
‚îú‚îÄ‚îÄ manifest.json                # Organism manifest
‚îú‚îÄ‚îÄ mkdocs.yml                   # –ö–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—è MkDocs
‚îú‚îÄ‚îÄ CNAME                        # –ö–∞—Å—Ç–æ–º–Ω–∏–π –¥–æ–º–µ–Ω
‚îî‚îÄ‚îÄ .github/workflows/
    ‚îî‚îÄ‚îÄ pages.yml                # GitHub Pages deployment workflow
```

## –ù–∞–≤—ñ–≥–∞—Ü—ñ—è (–≥–ª–æ–±–∞–ª—å–Ω–∞)

```
[ –ì–æ–ª–æ–≤–Ω–∞ ] [ Ci ] [ –ü–æ–î—ñ—è ] [ –ö–∞–∑–∫–∞—Ä ] [ Legend CI ] [ ... ]
```

- **–ì–æ–ª–æ–≤–Ω–∞** ‚Üí `/` ‚Äî —Å—Ç–∞—Ä—Ç–æ–≤–∞ —Å—Ç–æ—Ä—ñ–Ω–∫–∞ CiWiki
- **Legend CI** ‚Üí `/legend/` ‚Äî inner world

## –î–µ–ø–ª–æ–π

### GitHub Pages (–∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–∏–π)

Workflow: `.github/workflows/pages.yml`

–¢—Ä–∏–≥–µ—Ä: `push` –¥–æ –≥—ñ–ª–∫–∏ `main` –∞–±–æ `workflow_dispatch`.

–ö—Ä–æ–∫–∏:
1. Checkout –∫–æ–¥—É
2. –í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è Python + MkDocs Material
3. –ö–æ–ø—ñ—é–≤–∞–Ω–Ω—è `SECURITY.md` ‚Üí `docs/`
4. –ü–æ–±—É–¥–æ–≤–∞ Legend CI HTML —á–µ—Ä–µ–∑ `python scripts/legend/build_legend.py`
5. `mkdocs build` ‚Üí `site/`
6. –ö–æ–ø—ñ—é–≤–∞–Ω–Ω—è `api/` ‚Üí `site/api/`
7. –ö–æ–ø—ñ—é–≤–∞–Ω–Ω—è `CNAME` ‚Üí `site/CNAME`
8. `actions/configure-pages` + `actions/upload-pages-artifact` + `actions/deploy-pages`

### –õ–æ–∫–∞–ª—å–Ω–∏–π –∑–∞–ø—É—Å–∫ (Termux / Ubuntu)

```bash
# –í—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ –∑–∞–ª–µ–∂–Ω–æ—Å—Ç—ñ
pip install mkdocs mkdocs-material

# –ü—ñ–¥–≥–æ—Ç—É–≤–∞—Ç–∏ –¥–∏–Ω–∞–º—ñ—á–Ω—ñ —Ñ–∞–π–ª–∏
cp SECURITY.md docs/
python scripts/legend/build_legend.py

# –ó–∞–ø—É—Å—Ç–∏—Ç–∏ dev-—Å–µ—Ä–≤–µ—Ä
mkdocs serve

# –í—ñ–¥–∫—Ä–∏—Ç–∏ http://127.0.0.1:8000
```

–ó–±—ñ—Ä–∫–∞ —É –ø–∞–ø–∫—É `site/`:

```bash
mkdocs build
```

## –Ø–∫ –¥–æ–¥–∞—Ç–∏ –Ω–æ–≤—ñ —Å—Ç–æ—Ä—ñ–Ω–∫–∏

### –£ –∑–æ–≤–Ω—ñ—à–Ω—ñ–π —à–∞—Ä (CiWiki)

1. –°—Ç–≤–æ—Ä—ñ—Ç—å `docs/<section>/your-page.md`
2. –î–æ–¥–∞–π—Ç–µ –∑–∞–ø–∏—Å —É `nav:` –≤ `mkdocs.yml`

### –£ –≤–Ω—É—Ç—Ä—ñ—à–Ω—ñ–π —à–∞—Ä (Legend CI)

1. –ù–∞—Ä–∞—Ç–∏–≤–Ω—ñ —Ç–µ–∫—Å—Ç–∏: `docs/kazkar/legend-ci/`
2. –ù–æ–≤—ñ –≤—É–∑–ª–∏: –æ–Ω–æ–≤—ñ—Ç—å `docs/legend_ci/legend.graph.json`, –ø–æ—Ç—ñ–º `python scripts/legend/render.py`
3. –õ–µ–Ω–¥—ñ–Ω–≥: `docs/legend/index.md`

## Manifest

Organism manifest –∑–Ω–∞—Ö–æ–¥–∏—Ç—å—Å—è —É `manifest.json` (–∫–æ—Ä—ñ–Ω—å —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—é). –í—ñ–Ω –¥–µ–∫–ª–∞—Ä—É—î —à–∞—Ä–∏, –Ω–∞–≤—ñ–≥–∞—Ü—ñ–π–Ω—ñ –∫–æ—Ä–µ–Ω—ñ —Ç–∞ –º–µ—Ç–∞–¥–∞–Ω—ñ –∑–±—ñ—Ä–∫–∏/–¥–µ–ø–ª–æ—é.

## –ú–æ–¥—É–ª—å ¬´Legend CI¬ª {#legend-ci-module}

### –§–∞–π–ª–∏ –º–æ–¥—É–ª—è

| –§–∞–π–ª | –†–æ–ª—å |
|------|------|
| `docs/legend_ci/legend.graph.json` | Source-of-truth –≥—Ä–∞—Ñ (20 –≤—É–∑–ª—ñ–≤ + Ci, —Ä–µ–±—Ä–∞, ui-–º–µ—Ç–∞) |
| `docs/legend_ci/SCHEMA.legend.graph.json` | JSON Schema –¥–ª—è –≤–∞–ª—ñ–¥–∞—Ü—ñ—ó –≥—Ä–∞—Ñ—É |
| `docs/content/legend-ci.md` | –ö–∞–Ω–æ–Ω—ñ—á–Ω–∏–π –¥–æ–≤–≥–∏–π –Ω–∞—Ä—Ä–∞—Ç–∏–≤ (node index, —Å–∏–º–≤–æ–ª–∏, UX-—Ä–µ–∂–∏–º–∏) |
| `docs/_assets/legend/legend_ci_single.html` | –Ü–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞ SPA-–∫–∞—Ä—Ç–∞ (—Ä–∞–¥—ñ–∞–ª—å–Ω–∏–π –≤–∏–≥–ª—è–¥, –ø–µ—Ä–µ–º–∏–∫–∞–Ω–Ω—è —à–∞—Ä—ñ–≤, 3 —Ä–µ–∂–∏–º–∏) |
| `docs/kazkar/legend-ci/` | –†–æ–∑–≥–æ—Ä–Ω—É—Ç—ñ –Ω–∞—Ä–∞—Ç–∏–≤–∏ –¥–ª—è –≤—É–∑–ª—ñ–≤ 1‚Äì7 |
| `docs/legend/` | HTML-—Å—Ç–æ—Ä—ñ–Ω–∫–∏ –¥–ª—è –≤—Å—ñ—Ö 20 –≤—É–∑–ª—ñ–≤ (–≥–µ–Ω–µ—Ä—É—é—Ç—å—Å—è `build_legend.py`) |

### –£–º–æ–≤–∏ –∞–∫—Ç–∏–≤–∞—Ü—ñ—ó

- –ú–æ–¥—É–ª—å –∞–∫—Ç–∏–≤–Ω–∏–π –ø—Ä–∏ `status: "active"` —É `manifest.json ‚Üí modules[id="legend-ci"]`.
- –ì—Ä–∞—Ñ –≤–≤–∞–∂–∞—î—Ç—å—Å—è –≤–∞–ª—ñ–¥–Ω–∏–º –ø—ñ—Å–ª—è —É—Å–ø—ñ—à–Ω–æ–≥–æ `python scripts/legend/render.py`.
- –ë—É–¥—å-—è–∫–∞ –∑–º—ñ–Ω–∞ `legend.graph.json` **–ø–æ–≤–∏–Ω–Ω–∞** –≤—ñ–¥–æ–±—Ä–∞–∂–∞—Ç–∏—Å—è —É `manifest.json` (–æ–Ω–æ–≤–ª–µ–Ω–Ω—è –≤–µ—Ä—Å—ñ—ó –ø—Ä–∏ —Å—Ç—Ä—É–∫—Ç—É—Ä–Ω–∏—Ö –∑–º—ñ–Ω–∞—Ö).

### –†–µ–∂–∏–º–∏ –Ω–∞–≤—ñ–≥–∞—Ü—ñ—ó (UX)

| –†–µ–∂–∏–º | –û–ø–∏—Å |
|-------|------|
| –ù–µ–ª—ñ–Ω—ñ–π–Ω–∏–π | –†–∞–¥—ñ–∞–ª—å–Ω–∞ –∫–∞—Ä—Ç–∞; –≤—É–∑–ª–∏ –ø–æ–∑–∏—Ü—ñ–æ–Ω–æ–≤–∞–Ω—ñ –ø–æ –∫–æ–ª—É –Ω–∞–≤–∫–æ–ª–æ Ci |
| –õ—ñ–Ω—ñ–π–Ω–∏–π | –ü–æ—Å–ª—ñ–¥–æ–≤–Ω–∏–π —Å–ø–∏—Å–æ–∫ –≤—É–∑–ª—ñ–≤ 1‚Üí20 |
| –†–µ–∑–æ–Ω–∞–Ω—Å | –ü—É–ª—å—Å–∞—Ü—ñ—è + –ø–æ–∫–∞–∑ —Ä–µ–∑–æ–Ω–∞–Ω—Å–Ω–∏—Ö –∑–≤'—è–∑–∫—ñ–≤ (–±–∞–∑–æ–≤–∏–π –∞–ª–≥–æ—Ä–∏—Ç–º) |

### CRDT-—Ö—É–∫

–ü–µ—Ä—Å–æ–Ω–∞–ª—ñ–∑–æ–≤–∞–Ω–∏–π —Å—Ç–∞–Ω (`visited`, `depth`) –∑–∞—Ä–µ–∑–µ—Ä–≤–æ–≤–∞–Ω–∏–π –¥–ª—è –º–∞–π–±—É—Ç–Ω—å–æ—ó CRDT-—ñ–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—ó. –ü–æ—Ç–æ—á–Ω–∞ —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—è ‚Äî –±–µ–∑ —Å—Ç–∞–Ω—É (stateless).

## Ability: audit_supabase {#audit-supabase}

> **–°—Ç–∞—Ç—É—Å**: dormant (—Å–ø–µ—Ü–∏—Ñ—ñ–∫–∞—Ü—ñ—è –≥–æ—Ç–æ–≤–∞; runner —Ä–æ–∑–≥–æ—Ä—Ç–∞—î—Ç—å—Å—è —É consumer repos)

**–ü—Ä–∏–∑–Ω–∞—á–µ–Ω–Ω—è**: —á–∏—Ç–∞—Ç–∏ —Å—Ç–∞–Ω –±–∞–∑–∏ Supabase —á–µ—Ä–µ–∑ `psql` —ñ –∑–∞–ø–∏—Å—É–≤–∞—Ç–∏ –¥–µ—Ç–µ—Ä–º—ñ–Ω—ñ—Å—Ç–∏—á–Ω—ñ JSON-–∞—Ä—Ç–µ—Ñ–∞–∫—Ç–∏ —É `audit_out/`.

**–ö–æ–Ω—Ç—Ä–∞–∫—Ç –≤–∏–≤–æ–¥—É**: `audit_out/<query_id>.json` –∑ –ø–æ–ª—è–º–∏ `meta` (query_id, executed_at, executed_by, project_ref, psql_exit_code, duration_ms) —Ç–∞ `data` (–º–∞—Å–∏–≤ —Ä—è–¥–∫—ñ–≤).

**–ö–ª—é—á–æ–≤—ñ –ø—Ä–∏–Ω—Ü–∏–ø–∏**:
- `SUPABASE_DB_URL` ‚Äî –≤–∏–∫–ª—é—á–Ω–æ –∑ GitHub Secrets, –Ω—ñ–∫–æ–ª–∏ –Ω–µ –≤ –∫–æ–¥—ñ –∞–±–æ `.env` —É —Ä–µ–ø–æ.
- `SOFT_FAIL=1` –∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º: –ø–æ–º–∏–ª–∫–∏ –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è –Ω–µ –∑—É–ø–∏–Ω—è—é—Ç—å workflow.
- `query_id` ‚Äî –¥–µ—Ç–µ—Ä–º—ñ–Ω—ñ—Å—Ç–∏—á–Ω–∏–π slug `[a-z0-9-]`.

**–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—è**: [`docs/abilities/audit_supabase/README.md`](docs/abilities/audit_supabase/README.md)

**Rollout plan**:

| –ö—Ä–æ–∫ | –†–µ–ø–æ | –°—Ç–∞—Ç—É—Å |
|------|------|--------|
| 1. Spec | `Ihorog/ciwiki` | ‚úÖ |
| 2‚Äì4. Runner + workflow | `cit`, `ci_gitapi`, `cimeika-unified` | üî≤ |
| 5. Integration docs | `cimeika-backend` | üî≤ |
| 6. Docs only | `media` | üî≤ |

---

## –ë–µ–∑–ø–µ–∫–∞

- –°–∞–π—Ç —î –ø–æ–≤–Ω—ñ—Å—Ç—é —Å—Ç–∞—Ç–∏—á–Ω–∏–º (GitHub Pages, –±–µ–∑ —Å–µ—Ä–≤–µ—Ä–Ω–∏—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ñ–≤).
- –°–µ–∫—Ä–µ—Ç–∏ –∑–±–µ—Ä—ñ–≥–∞—é—Ç—å—Å—è –ª–∏—à–µ –≤ GitHub Secrets, –Ω–µ –≤ –∫–æ–¥—ñ.
- `docs/SECURITY.md` –≥–µ–Ω–µ—Ä—É—î—Ç—å—Å—è –∑ –∫–æ—Ä–µ–Ω–µ–≤–æ–≥–æ `SECURITY.md` –ø—ñ–¥ —á–∞—Å –∑–±—ñ—Ä–∫–∏.
